<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedQuiz HNU - Admin Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-app.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-auth.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-firestore.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-storage.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .dark-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }
        
        .dark-mode .glass-card {
            background: rgba(30, 30, 46, 0.95);
            color: white;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .stat-card {
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .sidebar {
            width: 280px;
            transition: all 0.3s ease;
        }
        
        .main-content {
            margin-left: 280px;
            transition: all 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 50;
                height: 100vh;
            }
            .sidebar.open {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
        }
        
        .drag-area {
            border: 3px dashed #cbd5e1;
            transition: all 0.3s ease;
        }
        
        .drag-area.dragover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .question-preview {
            border-left: 4px solid #667eea;
        }
        
        .folder-tree {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .tree-item {
            padding-left: 20px;
            border-left: 2px solid #e5e7eb;
        }
        
        .bulk-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .hidden { display: none !important; }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-active {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            border-right: 3px solid #667eea;
        }
        
        .dark-mode .tab-active {
            background: rgba(102, 126, 234, 0.2);
            color: #a78bfa;
            border-right-color: #a78bfa;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center">
        <div class="glass-card p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <i class="fas fa-user-shield text-6xl text-indigo-600 mb-4"></i>
                <h1 class="text-3xl font-bold text-gray-800 dark:text-white">Admin Portal</h1>
                <p class="text-gray-600 mt-2">MedQuiz HNU Management</p>
            </div>
            
            <div class="space-y-4">
                <input type="password" id="adminPassword" placeholder="Enter Admin Password" 
                    class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-indigo-500 text-center text-2xl tracking-widest">
                
                <button onclick="adminLogin()" class="w-full py-3 rounded-lg btn-primary text-white font-semibold">
                    <i class="fas fa-lock mr-2"></i>Login
                </button>
                
                <div id="loginError" class="text-red-500 text-center hidden"></div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="hidden">
        <!-- Sidebar -->
        <div class="sidebar fixed left-0 top-0 h-full glass-card overflow-y-auto">
            <div class="p-6 border-b dark:border-gray-700">
                <div class="flex items-center gap-3">
                    <i class="fas fa-user-shield text-3xl text-indigo-600"></i>
                    <div>
                        <h2 class="font-bold text-lg">Admin Panel</h2>
                        <p class="text-sm text-gray-500">MedQuiz HNU</p>
                    </div>
                </div>
            </div>
            
            <nav class="p-4 space-y-2">
                <button onclick="switchAdminTab('dashboard')" id="nav-dashboard" class="w-full text-left px-4 py-3 rounded-lg tab-active flex items-center gap-3">
                    <i class="fas fa-tachometer-alt"></i>Dashboard
                </button>
                <button onclick="switchAdminTab('content')" id="nav-content" class="w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-3 text-gray-600 dark:text-gray-400">
                    <i class="fas fa-folder-open"></i>Content Management
                </button>
                <button onclick="switchAdminTab('quizzes')" id="nav-quizzes" class="w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-3 text-gray-600 dark:text-gray-400">
                    <i class="fas fa-question-circle"></i>Quizzes
                </button>
                <button onclick="switchAdminTab('students')" id="nav-students" class="w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-3 text-gray-600 dark:text-gray-400">
                    <i class="fas fa-users"></i>Students
                </button>
                <button onclick="switchAdminTab('files')" id="nav-files" class="w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-3 text-gray-600 dark:text-gray-400">
                    <i class="fas fa-file-upload"></i>File Manager
                </button>
                <button onclick="switchAdminTab('notifications')" id="nav-notifications" class="w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-3 text-gray-600 dark:text-gray-400">
                    <i class="fas fa-bell"></i>Notifications
                </button>
                <button onclick="switchAdminTab('analytics')" id="nav-analytics" class="w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-3 text-gray-600 dark:text-gray-400">
                    <i class="fas fa-chart-bar"></i>Analytics
                </button>
            </nav>
            
            <div class="absolute bottom-0 left-0 right-0 p-4 border-t dark:border-gray-700">
                <button onclick="toggleDarkMode()" class="w-full mb-2 px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 transition flex items-center justify-center gap-2">
                    <i class="fas fa-moon dark:hidden"></i>
                    <i class="fas fa-sun hidden dark:inline"></i>
                    <span>Toggle Theme</span>
                </button>
                <button onclick="adminLogout()" class="w-full px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600 transition flex items-center justify-center gap-2">
                    <i class="fas fa-sign-out-alt"></i>Logout
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content p-6">
            <!-- Header -->
            <div class="flex justify-between items-center mb-6">
                <button onclick="toggleSidebar()" class="md:hidden p-2 rounded-lg bg-gray-200 dark:bg-gray-700">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 id="pageTitle" class="text-2xl font-bold">Dashboard</h1>
                <div class="flex items-center gap-4">
                    <span id="currentDate" class="text-gray-600 dark:text-gray-400"></span>
                </div>
            </div>

            <!-- Dashboard Tab -->
            <div id="tab-dashboard" class="fade-in">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="glass-card p-6 stat-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Total Students</p>
                                <h3 id="statStudents" class="text-3xl font-bold text-indigo-600">0</h3>
                            </div>
                            <div class="w-14 h-14 rounded-full bg-indigo-100 flex items-center justify-center">
                                <i class="fas fa-users text-2xl text-indigo-600"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-card p-6 stat-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Total Quizzes</p>
                                <h3 id="statQuizzes" class="text-3xl font-bold text-green-600">0</h3>
                            </div>
                            <div class="w-14 h-14 rounded-full bg-green-100 flex items-center justify-center">
                                <i class="fas fa-question-circle text-2xl text-green-600"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-card p-6 stat-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Total Questions</p>
                                <h3 id="statQuestions" class="text-3xl font-bold text-orange-600">0</h3>
                            </div>
                            <div class="w-14 h-14 rounded-full bg-orange-100 flex items-center justify-center">
                                <i class="fas fa-list text-2xl text-orange-600"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-card p-6 stat-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Active Today</p>
                                <h3 id="statActive" class="text-3xl font-bold text-purple-600">0</h3>
                            </div>
                            <div class="w-14 h-14 rounded-full bg-purple-100 flex items-center justify-center">
                                <i class="fas fa-user-clock text-2xl text-purple-600"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="glass-card p-6">
                        <h3 class="font-bold text-lg mb-4">Recent Activity</h3>
                        <div id="recentActivity" class="space-y-3 max-h-80 overflow-y-auto">
                            <!-- Activity items -->
                        </div>
                    </div>
                    
                    <div class="glass-card p-6">
                        <h3 class="font-bold text-lg mb-4">Top Performing Students</h3>
                        <div id="topStudents" class="space-y-3">
                            <!-- Student rankings -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Management Tab -->
            <div id="tab-content" class="hidden fade-in">
                <div class="glass-card p-6 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg">Folder Structure</h3>
                        <div class="flex gap-2">
                            <button onclick="openAddFolderModal()" class="px-4 py-2 rounded-lg btn-primary text-white">
                                <i class="fas fa-folder-plus mr-2"></i>Add Folder
                            </button>
                            <button onclick="openAddQuizModal()" class="px-4 py-2 rounded-lg bg-green-500 text-white hover:bg-green-600">
                                <i class="fas fa-plus-circle mr-2"></i>Add Quiz
                            </button>
                            <button onclick="openUploadModal()" class="px-4 py-2 rounded-lg bg-orange-500 text-white hover:bg-orange-600">
                                <i class="fas fa-upload mr-2"></i>Upload File
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex gap-4 mb-4">
                        <button onclick="setBulkMode(true)" id="bulkModeBtn" class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300">
                            <i class="fas fa-check-square mr-2"></i>Bulk Select
                        </button>
                        <button onclick="deleteSelected()" id="bulkDeleteBtn" class="hidden px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600">
                            <i class="fas fa-trash mr-2"></i>Delete Selected
                        </button>
                        <button onclick="setBulkMode(false)" id="cancelBulkBtn" class="hidden px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700">
                            Cancel
                        </button>
                    </div>
                    
                    <div id="folderTree" class="folder-tree">
                        <!-- Folder tree rendered here -->
                    </div>
                </div>
            </div>

            <!-- Quizzes Tab -->
            <div id="tab-quizzes" class="hidden fade-in">
                <div class="glass-card p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg">All Quizzes</h3>
                        <div class="flex gap-2">
                            <button onclick="importQuiz()" class="px-4 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600">
                                <i class="fas fa-file-import mr-2"></i>Import
                            </button>
                            <button onclick="exportAllQuizzes()" class="px-4 py-2 rounded-lg bg-purple-500 text-white hover:bg-purple-600">
                                <i class="fas fa-file-export mr-2"></i>Export All
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b dark:border-gray-700">
                                    <th class="text-left py-3 px-4">Title</th>
                                    <th class="text-left py-3 px-4">Folder</th>
                                    <th class="text-left py-3 px-4">Questions</th>
                                    <th class="text-left py-3 px-4">Duration</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="quizzesTable">
                                <!-- Quiz rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Students Tab -->
            <div id="tab-students" class="hidden fade-in">
                <div class="glass-card p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg">Student Management</h3>
                        <input type="text" id="studentSearch" onkeyup="searchStudents()" placeholder="Search students..." 
                            class="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800">
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b dark:border-gray-700">
                                    <th class="text-left py-3 px-4">Username</th>
                                    <th class="text-left py-3 px-4">Joined</th>
                                    <th class="text-left py-3 px-4">Quizzes Taken</th>
                                    <th class="text-left py-3 px-4">Avg Score</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTable">
                                <!-- Student rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- File Manager Tab -->
            <div id="tab-files" class="hidden fade-in">
                <div class="glass-card p-6">
                    <h3 class="font-bold text-lg mb-4">File Manager</h3>
                    
                    <div class="drag-area rounded-lg p-8 text-center mb-6" id="dropZone"
                        ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                        <i class="fas fa-cloud-upload-alt text-5xl text-gray-400 mb-4"></i>
                        <p class="text-lg mb-2">Drag & Drop files here</p>
                        <p class="text-sm text-gray-500 mb-4">or</p>
                        <input type="file" id="fileInput" multiple class="hidden" onchange="handleFileSelect(event)">
                        <button onclick="document.getElementById('fileInput').click()" class="px-6 py-2 rounded-lg btn-primary text-white">
                            Browse Files
                        </button>
                        <p class="text-xs text-gray-500 mt-4">Supported: PDF, Word, PowerPoint, Images</p>
                    </div>
                    
                    <div id="uploadProgress" class="hidden mb-4">
                        <div class="flex justify-between text-sm mb-1">
                            <span>Uploading...</span>
                            <span id="uploadPercent">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="uploadBar" class="bg-indigo-600 h-2 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div id="filesList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Files grid -->
                    </div>
                </div>
            </div>

            <!-- Notifications Tab -->
            <div id="tab-notifications" class="hidden fade-in">
                <div class="glass-card p-6">
                    <h3 class="font-bold text-lg mb-4">Send Notification</h3>
                    
                    <div class="space-y-4 mb-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">Recipients</label>
                            <select id="notifTarget" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800">
                                <option value="all">All Students</option>
                                <option value="specific">Specific Student</option>
                            </select>
                        </div>
                        
                        <div id="specificStudentDiv" class="hidden">
                            <label class="block text-sm font-medium mb-2">Student Username</label>
                            <input type="text" id="notifStudent" placeholder="Enter username" 
                                class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Title</label>
                            <input type="text" id="notifTitle" placeholder="Notification title" 
                                class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Message</label>
                            <textarea id="notifMessage" rows="4" placeholder="Enter your message..." 
                                class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800"></textarea>
                        </div>
                        
                        <button onclick="sendNotification()" class="w-full py-3 rounded-lg btn-primary text-white font-semibold">
                            <i class="fas fa-paper-plane mr-2"></i>Send Notification
                        </button>
                    </div>
                    
                    <h4 class="font-bold mb-3">Recent Notifications</h4>
                    <div id="notifHistory" class="space-y-3 max-h-64 overflow-y-auto">
                        <!-- Notification history -->
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="tab-analytics" class="hidden fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="glass-card p-6">
                        <h3 class="font-bold text-lg mb-4">Quiz Performance</h3>
                        <canvas id="quizChart" width="400" height="300"></canvas>
                    </div>
                    
                    <div class="glass-card p-6">
                        <h3 class="font-bold text-lg mb-4">Student Activity</h3>
                        <canvas id="activityChart" width="400" height="300"></canvas>
                    </div>
                </div>
                
                <div class="glass-card p-6 mt-6">
                    <h3 class="font-bold text-lg mb-4">Detailed Analytics</h3>
                    <div id="detailedAnalytics" class="space-y-4">
                        <!-- Detailed stats -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Folder Modal -->
    <div id="folderModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="glass-card w-full max-w-md p-6">
            <h3 class="text-xl font-bold mb-4">Add New Folder</h3>
            <input type="text" id="folderName" placeholder="Folder Name" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800 mb-4">
            <input type="text" id="folderDesc" placeholder="Description (optional)" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800 mb-4">
            <select id="folderParent" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800 mb-4">
                <option value="">Root Level</option>
            </select>
            <div class="flex justify-end gap-2">
                <button onclick="closeModal('folderModal')" class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700">Cancel</button>
                <button onclick="saveFolder()" class="px-4 py-2 rounded-lg btn-primary text-white">Save Folder</button>
            </div>
        </div>
    </div>

    <!-- Add Quiz Modal -->
    <div id="quizModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto">
        <div class="glass-card w-full max-w-4xl p-6 max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl font-bold mb-4">Create New Quiz</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <input type="text" id="quizTitle" placeholder="Quiz Title" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800">
                <select id="quizFolder" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800">
                    <option value="">Select Folder</option>
                </select>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <input type="number" id="quizDuration" placeholder="Duration (minutes)" value="30" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800">
                <input type="number" id="quizPassing" placeholder="Passing Score %" value="60" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800">
                <select id="quizShuffle" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800">
                    <option value="true">Shuffle Questions</option>
                    <option value="false">Keep Order</option>
                </select>
            </div>
            
            <div class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <h4 class="font-bold">Questions</h4>
                    <button onclick="addQuestionField()" class="px-3 py-1 rounded bg-green-500 text-white text-sm">
                        <i class="fas fa-plus mr-1"></i>Add Question
                    </button>
                </div>
                <div id="questionsContainer" class="space-y-4 max-h-96 overflow-y-auto">
                    <!-- Question fields -->
                </div>
            </div>
            
            <div class="flex justify-between items-center">
                <button onclick="previewQuiz()" class="px-4 py-2 rounded-lg bg-blue-500 text-white">
                    <i class="fas fa-eye mr-2"></i>Preview
                </button>
                <div class="flex gap-2">
                    <button onclick="closeModal('quizModal')" class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700">Cancel</button>
                    <button onclick="saveQuiz()" class="px-4 py-2 rounded-lg btn-primary text-white">Save Quiz</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div id="previewModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="glass-card w-full max-w-2xl p-6 max-h-[80vh] overflow-y-auto">
            <h3 class="text-xl font-bold mb-4">Quiz Preview</h3>
            <div id="previewContent" class="space-y-4"></div>
            <div class="flex justify-end mt-4">
                <button onclick="closeModal('previewModal')" class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB001YxSS9iQ6PArK1VHf0lIlpLyP1Rqew",
            authDomain: "medquiz-hnu.firebaseapp.com",
            projectId: "medquiz-hnu",
            storageBucket: "medquiz-hnu.firebasestorage.app",
            messagingSenderId: "862221476635",
            appId: "1:862221476635:web:369ca0e1f3b22b3eac29be",
            measurementId: "G-4T9XPB89N7"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const storage = firebase.storage();

        let currentAdmin = false;
        let bulkMode = false;
        let selectedItems = new Set();
        let questionCount = 0;

        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === 'jana') {
                currentAdmin = true;
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
                loadDashboard();
                updateDate();
            } else {
                document.getElementById('loginError').textContent = 'Invalid password';
                document.getElementById('loginError').classList.remove('hidden');
            }
        }

        function adminLogout() {
            currentAdmin = false;
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('adminPassword').value = '';
        }

        function updateDate() {
            const date = new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            document.getElementById('currentDate').textContent = date;
        }

        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('open');
        }

        function switchAdminTab(tab) {
            // Hide all tabs
            document.querySelectorAll('[id^="tab-"]').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('[id^="nav-"]').forEach(el => {
                el.classList.remove('tab-active');
                el.classList.add('text-gray-600', 'dark:text-gray-400');
            });
            
            // Show selected tab
            document.getElementById(`tab-${tab}`).classList.remove('hidden');
            document.getElementById(`nav-${tab}`).classList.add('tab-active');
            document.getElementById(`nav-${tab}`).classList.remove('text-gray-600', 'dark:text-gray-400');
            
            document.getElementById('pageTitle').textContent = tab.charAt(0).toUpperCase() + tab.slice(1);
            
            // Load tab data
            if (tab === 'dashboard') loadDashboard();
            else if (tab === 'content') loadFolderTree();
            else if (tab === 'quizzes') loadQuizzes();
            else if (tab === 'students') loadStudents();
            else if (tab === 'files') loadFiles();
            else if (tab === 'notifications') loadNotifHistory();
            else if (tab === 'analytics') loadAnalytics();
        }

        async function loadDashboard() {
            // Get stats
            const studentsSnap = await db.collection('students').get();
            const quizzesSnap = await db.collection('quizzes').get();
            
            let totalQuestions = 0;
            for (const quiz of quizzesSnap.docs) {
                const qSnap = await db.collection('quizzes').doc(quiz.id).collection('questions').get();
                totalQuestions += qSnap.size;
            }
            
            // Active today (simplified - in real app, track login timestamps)
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            document.getElementById('statStudents').textContent = studentsSnap.size;
            document.getElementById('statQuizzes').textContent = quizzesSnap.size;
            document.getElementById('statQuestions').textContent = totalQuestions;
            document.getElementById('statActive').textContent = Math.floor(Math.random() * 20) + 5; // Placeholder
        }

        async function loadFolderTree() {
            const container = document.getElementById('folderTree');
            const foldersSnap = await db.collection('folders').get();
            
            const folders = {};
            foldersSnap.forEach(doc => {
                folders[doc.id] = { ...doc.data(), id: doc.id, children: [] };
            });
            
            // Build tree
            const tree = [];
            Object.values(folders).forEach(folder => {
                if (folder.parentId && folders[folder.parentId]) {
                    folders[folder.parentId].children.push(folder);
                } else {
                    tree.push(folder);
                }
            });
            
            function renderTree(nodes, level = 0) {
                let html = '';
                nodes.forEach(node => {
                    const indent = level * 20;
                    html += `
                        <div class="tree-item py-2" style="margin-left: ${indent}px">
                            <div class="flex items-center justify-between p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 group">
                                <div class="flex items-center gap-3" onclick="toggleFolder('${node.id}')">
                                    <i class="fas fa-folder text-indigo-500"></i>
                                    <span class="font-medium">${node.name}</span>
                                    ${bulkMode ? `<input type="checkbox" class="bulk-checkbox ml-2" onchange="toggleSelect('${node.id}')">` : ''}
                                </div>
                                <div class="hidden group-hover:flex gap-2">
                                    <button onclick="editFolder('${node.id}')" class="p-1 text-blue-500 hover:bg-blue-100 rounded"><i class="fas fa-edit"></i></button>
                                    <button onclick="deleteFolder('${node.id}')" class="p-1 text-red-500 hover:bg-red-100 rounded"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            ${node.children.length > 0 ? `<div id="children-${node.id}" class="">${renderTree(node.children, level + 1)}</div>` : ''}
                        </div>
                    `;
                });
                return html;
            }
            
            container.innerHTML = renderTree(tree) || '<p class="text-gray-500 text-center py-4">No folders yet</p>';
            
            // Update selects
            updateFolderSelects(foldersSnap);
        }

        function toggleFolder(id) {
            const children = document.getElementById(`children-${id}`);
            if (children) {
                children.classList.toggle('hidden');
            }
        }

        function updateFolderSelects(snapshot) {
            const selects = ['folderParent', 'quizFolder'];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                const currentValue = select.value;
                select.innerHTML = selectId === 'folderParent' ? '<option value="">Root Level</option>' : '<option value="">Select Folder</option>';
                
                snapshot.forEach(doc => {
                    const folder = doc.data();
                    select.innerHTML += `<option value="${doc.id}">${folder.name}</option>`;
                });
                
                select.value = currentValue;
            });
        }

        function setBulkMode(enable) {
            bulkMode = enable;
            selectedItems.clear();
            
            document.getElementById('bulkModeBtn').classList.toggle('hidden', enable);
            document.getElementById('bulkDeleteBtn').classList.toggle('hidden', !enable);
            document.getElementById('cancelBulkBtn').classList.toggle('hidden', !enable);
            
            loadFolderTree();
        }

        function toggleSelect(id) {
            if (selectedItems.has(id)) {
                selectedItems.delete(id);
            } else {
                selectedItems.add(id);
            }
        }

        async function deleteSelected() {
            if (!confirm(`Delete ${selectedItems.size} selected items?`)) return;
            
            for (const id of selectedItems) {
                await db.collection('folders').doc(id).delete();
            }
            
            selectedItems.clear();
            setBulkMode(false);
            loadFolderTree();
        }

        function openAddFolderModal() {
            document.getElementById('folderModal').classList.remove('hidden');
        }

        function openAddQuizModal() {
            questionCount = 0;
            document.getElementById('questionsContainer').innerHTML = '';
            addQuestionField();
            document.getElementById('quizModal').classList.remove('hidden');
        }

        function openUploadModal() {
            document.getElementById('tab-files').classList.remove('hidden');
            switchAdminTab('files');
        }

        function addQuestionField() {
            questionCount++;
            const container = document.getElementById('questionsContainer');
            const div = document.createElement('div');
            div.className = 'question-preview p-4 bg-gray-50 dark:bg-gray-800 rounded-lg';
            div.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <span class="font-bold">Question ${questionCount}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-red-500 hover:text-red-700"><i class="fas fa-times"></i></button>
                </div>
                <textarea class="w-full px-3 py-2 rounded border border-gray-300 dark:border-gray-600 dark:bg-gray-700 mb-2" placeholder="Question text" rows="2"></textarea>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-2 mb-2">
                    <input type="text" class="option-input w-full px-3 py-2 rounded border border-gray-300 dark:border-gray-600 dark:bg-gray-700" placeholder="Option A">
                    <input type="text" class="option-input w-full px-3 py-2 rounded border border-gray-300 dark:border-gray-600 dark:bg-gray-700" placeholder="Option B">
                    <input type="text" class="option-input w-full px-3 py-2 rounded border border-gray-300 dark:border-gray-600 dark:bg-gray-700" placeholder="Option C">
                    <input type="text" class="option-input w-full px-3 py-2 rounded border border-gray-300 dark:border-gray-600 dark:bg-gray-700" placeholder="Option D">
                </div>
                <div class="flex gap-2">
                    <select class="correct-answer px-3 py-2 rounded border border-gray-300 dark:border-gray-600 dark:bg-gray-700">
                        <option value="0">A is correct</option>
                        <option value="1">B is correct</option>
                        <option value="2">C is correct</option>
                        <option value="3">D is correct</option>
                    </select>
                    <input type="text" class="explanation flex-1 px-3 py-2 rounded border border-gray-300 dark:border-gray-600 dark:bg-gray-700" placeholder="Explanation (optional)">
                </div>
            `;
            container.appendChild(div);
        }

        function previewQuiz() {
            const title = document.getElementById('quizTitle').value;
            const questions = [];
            
            document.querySelectorAll('.question-preview').forEach(q => {
                const text = q.querySelector('textarea').value;
                const options = Array.from(q.querySelectorAll('.option-input')).map(i => i.value);
                const correct = parseInt(q.querySelector('.correct-answer').value);
                const explanation = q.querySelector('.explanation').value;
                
                if (text && options.every(o => o)) {
                    questions.push({ text, options, correct, explanation });
                }
            });
            
            let html = `<h4 class="font-bold text-lg mb-4">${title || 'Untitled Quiz'}</h4>`;
            questions.forEach((q, idx) => {
                html += `
                    <div class="mb-4 p-4 border rounded-lg">
                        <p class="font-medium mb-2">${idx + 1}. ${q.text}</p>
                        <div class="space-y-1 ml-4">
                            ${q.options.map((opt, i) => `
                                <div class="${i === q.correct ? 'text-green-600 font-bold' : ''}">
                                    ${String.fromCharCode(65 + i)}. ${opt} ${i === q.correct ? '(Correct)' : ''}
                                </div>
                            `).join('')}
                        </div>
                        ${q.explanation ? `<p class="mt-2 text-sm text-blue-600"><i class="fas fa-info-circle mr-1"></i>${q.explanation}</p>` : ''}
                    </div>
                `;
            });
            
            document.getElementById('previewContent').innerHTML = html;
            document.getElementById('previewModal').classList.remove('hidden');
        }

        async function saveQuiz() {
            const title = document.getElementById('quizTitle').value;
            const folderId = document.getElementById('quizFolder').value;
            const duration = parseInt(document.getElementById('quizDuration').value) || 30;
            const passingScore = parseInt(document.getElementById('quizPassing').value) || 60;
            
            if (!title || !folderId) {
                alert('Please fill in title and select folder');
                return;
            }
            
            const questions = [];
            document.querySelectorAll('.question-preview').forEach(q => {
                const text = q.querySelector('textarea').value;
                const options = Array.from(q.querySelectorAll('.option-input')).map(i => i.value);
                const correctAnswer = parseInt(q.querySelector('.correct-answer').value);
                const explanation = q.querySelector('.explanation').value;
                
                if (text && options.every(o => o)) {
                    questions.push({ text, options, correctAnswer, explanation });
                }
            });
            
            if (questions.length === 0) {
                alert('Please add at least one question');
                return;
            }
            
            const quizRef = await db.collection('quizzes').add({
                title,
                folderId,
                duration,
                passingScore,
                questionCount: questions.length,
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                shuffle: document.getElementById('quizShuffle').value === 'true'
            });
            
            // Add questions as subcollection
            const batch = db.batch();
            questions.forEach((q, idx) => {
                const qRef = db.collection('quizzes').doc(quizRef.id).collection('questions').doc();
                batch.set(qRef, q);
            });
            await batch.commit();
            
            closeModal('quizModal');
            alert('Quiz saved successfully!');
            loadQuizzes();
        }

        async function loadQuizzes() {
            const snapshot = await db.collection('quizzes').get();
            const tbody = document.getElementById('quizzesTable');
            
            let html = '';
            for (const doc of snapshot.docs) {
                const quiz = doc.data();
                const folderDoc = quiz.folderId ? await db.collection('folders').doc(quiz.folderId).get() : null;
                const folderName = folderDoc && folderDoc.exists ? folderDoc.data().name : 'Unknown';
                
                html += `
                    <tr class="border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800">
                        <td class="py-3 px-4">${quiz.title}</td>
                        <td class="py-3 px-4">${folderName}</td>
                        <td class="py-3 px-4">${quiz.questionCount}</td>
                        <td class="py-3 px-4">${quiz.duration} min</td>
                        <td class="py-3 px-4">
                            <button onclick="editQuiz('${doc.id}')" class="text-blue-500 hover:text-blue-700 mr-2"><i class="fas fa-edit"></i></button>
                            <button onclick="deleteQuiz('${doc.id}')" class="text-red-500 hover:text-red-700 mr-2"><i class="fas fa-trash"></i></button>
                            <button onclick="exportQuiz('${doc.id}')" class="text-green-500 hover:text-green-700"><i class="fas fa-download"></i></button>
                        </td>
                    </tr>
                `;
            }
            
            tbody.innerHTML = html || '<tr><td colspan="5" class="text-center py-4 text-gray-500">No quizzes found</td></tr>';
        }

        async function loadStudents() {
            const snapshot = await db.collection('students').get();
            const tbody = document.getElementById('studentsTable');
            
            let html = '';
            for (const doc of snapshot.docs) {
                const student = doc.data();
                const historySnap = await db.collection('students').doc(doc.id).collection('history').get();
                
                let totalScore = 0;
                historySnap.forEach(h => totalScore += h.data().score);
                const avgScore = historySnap.size > 0 ? Math.round(totalScore / historySnap.size) : 0;
                
                html += `
                    <tr class="border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800">
                        <td class="py-3 px-4 font-medium">${student.username}</td>
                        <td class="py-3 px-4">${student.createdAt ? new Date(student.createdAt.toDate()).toLocaleDateString() : 'N/A'}</td>
                        <td class="py-3 px-4">${historySnap.size}</td>
                        <td class="py-3 px-4">
                            <span class="px-2 py-1 rounded ${avgScore >= 80 ? 'bg-green-100 text-green-800' : avgScore >= 60 ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}">
                                ${avgScore}%
                            </span>
                        </td>
                        <td class="py-3 px-4">
                            <button onclick="viewStudent('${doc.id}')" class="text-blue-500 hover:text-blue-700 mr-2"><i class="fas fa-eye"></i></button>
                            <button onclick="deleteStudent('${doc.id}')" class="text-red-500 hover:text-red-700"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            }
            
            tbody.innerHTML = html || '<tr><td colspan="5" class="text-center py-4 text-gray-500">No students found</td></tr>';
        }

        // File Management
        function handleDragOver(e) {
            e.preventDefault();
            document.getElementById('dropZone').classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            document.getElementById('dropZone').classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            document.getElementById('dropZone').classList.remove('dragover');
            const files = e.dataTransfer.files;
            uploadFiles(files);
        }

        function handleFileSelect(e) {
            uploadFiles(e.target.files);
        }

        async function uploadFiles(files) {
            const progressDiv = document.getElementById('uploadProgress');
            const progressBar = document.getElementById('uploadBar');
            const progressText = document.getElementById('uploadPercent');
            
            progressDiv.classList.remove('hidden');
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const storageRef = storage.ref(`files/${Date.now()}_${file.name}`);
                
                const uploadTask = storageRef.put(file);
                
                uploadTask.on('state_changed', 
                    (snapshot) => {
                        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        progressBar.style.width = `${progress}%`;
                        progressText.textContent = `${Math.round(progress)}%`;
                    },
                    (error) => {
                        console.error('Upload error:', error);
                    },
                    async () => {
                        const url = await uploadTask.snapshot.ref.getDownloadURL();
                        await db.collection('files').add({
                            name: file.name,
                            type: file.type,
                            size: formatFileSize(file.size),
                            url: url,
                            uploadedAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        
                        if (i === files.length - 1) {
                            setTimeout(() => {
                                progressDiv.classList.add('hidden');
                                loadFiles();
                            }, 1000);
                        }
                    }
                );
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        async function loadFiles() {
            const snapshot = await db.collection('files').orderBy('uploadedAt', 'desc').get();
            const container = document.getElementById('filesList');
            
            let html = '';
            snapshot.forEach(doc => {
                const file = doc.data();
                const icon = file.type.includes('pdf') ? 'fa-file-pdf text-red-500' : 
                            file.type.includes('word') ? 'fa-file-word text-blue-500' :
                            file.type.includes('powerpoint') ? 'fa-file-powerpoint text-orange-500' :
                            file.type.includes('image') ? 'fa-file-image text-purple-500' : 'fa-file text-gray-500';
                
                html += `
                    <div class="glass-card p-4 flex items-center gap-4">
                        <i class="fas ${icon} text-3xl"></i>
                        <div class="flex-1 min-w-0">
                            <p class="font-medium truncate">${file.name}</p>
                            <p class="text-sm text-gray-500">${file.size}  ${new Date(file.uploadedAt.toDate()).toLocaleDateString()}</p>
                        </div>
                        <div class="flex gap-2">
                            <a href="${file.url}" target="_blank" class="p-2 text-blue-500 hover:bg-blue-100 rounded"><i class="fas fa-eye"></i></a>
                            <a href="${file.url}" download class="p-2 text-green-500 hover:bg-green-100 rounded"><i class="fas fa-download"></i></a>
                            <button onclick="deleteFile('${doc.id}')" class="p-2 text-red-500 hover:bg-red-100 rounded"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<p class="text-gray-500 text-center col-span-3">No files uploaded</p>';
        }

        // Notifications
        document.getElementById('notifTarget').addEventListener('change', function() {
            document.getElementById('specificStudentDiv').classList.toggle('hidden', this.value !== 'specific');
        });

        async function sendNotification() {
            const target = document.getElementById('notifTarget').value;
            const title = document.getElementById('notifTitle').value;
            const message = document.getElementById('notifMessage').value;
            const student = document.getElementById('notifStudent').value;
            
            if (!title || !message) {
                alert('Please fill in title and message');
                return;
            }
            
            await db.collection('notifications').add({
                title,
                message,
                recipient: target === 'all' ? 'all' : student,
                read: false,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            });
            
            alert('Notification sent!');
            document.getElementById('notifTitle').value = '';
            document.getElementById('notifMessage').value = '';
            loadNotifHistory();
        }

        async function loadNotifHistory() {
            const snapshot = await db.collection('notifications').orderBy('timestamp', 'desc').limit(20).get();
            const container = document.getElementById('notifHistory');
            
            let html = '';
            snapshot.forEach(doc => {
                const notif = doc.data();
                html += `
                    <div class="p-3 bg-gray-50 dark:bg-gray-800 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-bold">${notif.title}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">${notif.message}</p>
                                <p class="text-xs text-gray-500 mt-1">To: ${notif.recipient}</p>
                            </div>
                            <span class="text-xs text-gray-500">${new Date(notif.timestamp.toDate()).toLocaleDateString()}</span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<p class="text-gray-500 text-center">No notifications sent</p>';
        }

        // Export/Import
        async function exportQuiz(quizId) {
            const quizDoc = await db.collection('quizzes').doc(quizId).get();
            const questionsSnap = await db.collection('quizzes').doc(quizId).collection('questions').get();
            
            const exportData = {
                quiz: quizDoc.data(),
                questions: []
            };
            
            questionsSnap.forEach(q => exportData.questions.push(q.data()));
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${exportData.quiz.title.replace(/\s+/g, '_')}.json`;
            a.click();
        }

        function importQuiz() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                const text = await file.text();
                const data = JSON.parse(text);
                
                // Create quiz
                const quizRef = await db.collection('quizzes').add({
                    ...data.quiz,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Add questions
                const batch = db.batch();
                data.questions.forEach(q => {
                    const qRef = db.collection('quizzes').doc(quizRef.id).collection('questions').doc();
                    batch.set(qRef, q);
                });
                await batch.commit();
                
                alert('Quiz imported successfully!');
                loadQuizzes();
            };
            input.click();
        }

        // Utilities
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        async function saveFolder() {
            const name = document.getElementById('folderName').value;
            const desc = document.getElementById('folderDesc').value;
            const parentId = document.getElementById('folderParent').value || null;
            
            if (!name) {
                alert('Please enter folder name');
                return;
            }
            
            await db.collection('folders').add({
                name,
                description: desc,
                parentId,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            
            closeModal('folderModal');
            document.getElementById('folderName').value = '';
            document.getElementById('folderDesc').value = '';
            loadFolderTree();
        }

        async function deleteFolder(id) {
            if (!confirm('Delete this folder?')) return;
            await db.collection('folders').doc(id).delete();
            loadFolderTree();
        }

        async function deleteQuiz(id) {
            if (!confirm('Delete this quiz?')) return;
            
            // Delete questions subcollection
            const questionsSnap = await db.collection('quizzes').doc(id).collection('questions').get();
            const batch = db.batch();
            questionsSnap.forEach(q => batch.delete(q.ref));
            await batch.commit();
            
            await db.collection('quizzes').doc(id).delete();
            loadQuizzes();
        }

        async function deleteFile(id) {
            if (!confirm('Delete this file?')) return;
            await db.collection('files').doc(id).delete();
            loadFiles();
        }

        async function deleteStudent(id) {
            if (!confirm('Delete this student and all their data?')) return;
            await db.collection('students').doc(id).delete();
            loadStudents();
        }

        function searchStudents() {
            const query = document.getElementById('studentSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#studentsTable tr');
            
            rows.forEach(row => {
                const username = row.cells[0]?.textContent.toLowerCase() || '';
                row.style.display = username.includes(query) ? '' : 'none';
            });
        }

        function loadAnalytics() {
            // Placeholder for charts - in real implementation, use Chart.js
            document.getElementById('detailedAnalytics').innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg">
                        <p class="text-sm text-gray-600">Average Quiz Score</p>
                        <p class="text-2xl font-bold text-indigo-600">72%</p>
                    </div>
                    <div class="p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                        <p class="text-sm text-gray-600">Completion Rate</p>
                        <p class="text-2xl font-bold text-green-600">85%</p>
                    </div>
                    <div class="p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
                        <p class="text-sm text-gray-600">Most Active Day</p>
                        <p class="text-2xl font-bold text-orange-600">Monday</p>
                    </div>
                </div>
            `;
        }

        // Close modals on outside click
        window.onclick = function(event) {
            if (event.target.classList.contains('fixed')) {
                event.target.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
